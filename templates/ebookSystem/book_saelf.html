{% extends "base_nav.html" %}
{% load staticfiles %}
{% block title %}
借閱書櫃
{% endblock %}
{% block header %}
借閱書櫃
{% endblock %}
{% block content %}
{% csrf_token %}


<script>

	$(function(){

		//tabid
		let tabid;

		// //v
		// let c=$('#srvdata_正借閱書籍').html();
		// c=replace(c,'\r\n','');
		// c=replace(c,'\r','');
		// c=replace(c,'\n','');
		// c=replace(c,'\t','');
		// c=strdelright(c,1);
		// c='['+c+']';
		// let v=j2o(c);

		// //arr2dict
		// let d=arr2dict(v);

		// //tabid
		// tabid='saelf_books_table_正借閱書籍';

		// //dict2grid
		// let h=dict2grid(d,tabid);
		// $('#saelf_books_tab_正借閱書籍').html(h);

		//table style, pagin
		tabid='saelf_books_table_正借閱書籍';
		grid2bstable(tabid);
		pagin(tabid);

		//table style, pagin
		tabid='saelf_books_table_借閱歷史紀錄';
		grid2bstable(tabid);
		pagin(tabid);

	})


</script>


<!-- <script id="srvdata_正借閱書籍" type="text/x-custom-template">
	["書名","借出日期","到期日期","url","id"],
	{% for lr in lr_out_list %}
	[
		"{{ lr.book }}",
		"{{ lr.check_out_time }}",
		"{{ lr.check_in_time }}",
		"{%url 'ebookSystem:library_view' %}?ISBN={{ lr.book.ISBN }}",
		"{{ lr.id }}"
	],
	{% endfor %}
</script> -->


<h3>借閱書櫃</h3>


<ul class="nav nav-tabs">
	<li class="active"><a href="#saelf_books_tab_正借閱書籍" name="saelf_books_tab_grp" data-toggle="tab" aria-expanded="true" onclick="pagetab_subtabfix(this);">正借閱書籍</a></li>
	<li><a href="#saelf_books_tab_借閱歷史紀錄" name="saelf_books_tab_grp" data-toggle="tab" aria-expanded="false" onclick="pagetab_subtabfix(this);">借閱歷史紀錄</a></li>
</ul>


<div class="tab-content" style="padding:20px 0px;">

	<div id="saelf_books_tab_正借閱書籍" class="tab-pane active">

		<table class="no-page" id="saelf_books_table_正借閱書籍">
			<thead>
				<tr>
					<th>書名</th>
					<th>借出日期</th>
					<th>到期日期</th>
					<th>動作</th>
				</tr>
			</thead>
			<tbody>
				{% for lr in lr_out_list %}
				<tr>
					<td>{{ lr.book }}</td>
					<td>{{ lr.check_out_time }}</td>
					<td>{{ lr.check_in_time }}</td>
					<td>
						<a class="btn btn-default" role="button" href="{%url 'ebookSystem:library_view' %}?ISBN={{ lr.book.ISBN }}" target="_blank" title="閱讀(另開新視窗)">閱讀</a>
						<button type="button" class="btn btn-default" id="{{ lr.id }}" onclick="aj_borrowbook(this, 'check_in')">歸還</button>
					</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>

	</div>

	<div id="saelf_books_tab_借閱歷史紀錄" class="tab-pane">

		<table class="no-page" id="saelf_books_table_借閱歷史紀錄">
			<thead>
				<tr>
					<th>書名</th>
					<th>借出日期</th>
					<th>歸還日期</th>
				</tr>
			</thead>
			</body>
				{% for lr in lr_in_list %}
				<tr>
					<td>{{ lr.book }}</td>
					<td>{{ lr.check_out_time }}</td>
					<td>{{ lr.check_in_time }}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>

	</div>

</div>


{% endblock %}