<script>

	function ServiceinfoEditrecord_getdata(editrecord_set){

		//userid
		let userid = $('div[user_id]').attr('user_id');

		//client
		let client = new $.RestClient('/ebookSystem/api/');
		client.add('editrecords');
		
		//p
		let p=[];
		_.each(editrecord_set,function(id){
			p.push(client.editrecords.read(id));
		})

		//all
		Promise.all(p)
		.then(function(data){
			//console.log('Promise.all',data)

			//sr
			let sr = [];
			_.each(data, function (v, k) {
				let o = {
					'服務時間': v.get_date,
					'ISBN-Part': v.part,
					'服務時數': v.service_hours,
					'線上時數': v.stay_hours,
					'類型': v.category,
				};
				sr.push(o);
			})

			//gentable
			gentable('divmodal_ServiceinfoEditrecord_panel', 'divmodal_ServiceinfoEditrecord_table', sr);

			//table
			$('#divmodal_ServiceinfoEditrecord_table').find('tr').each(function () {
				let tr = $(this);
				tr.css('text-align', 'center');
			})

		})

	}

	function ServiceinfoEditrecord(editrecord_set) {
		//顯示與編輯使用者手冊

		//check
		if(iser(editrecord_set)){
			alertmessage('error', '未有任何兌換紀錄');
			return '';
		}

		//div
		let div = $('#divmodal_ServiceinfoEditrecord');

		//show data
		ServiceinfoEditrecord_getdata(editrecord_set);

		//ok
		$('#divmodal_ServiceinfoEditrecord_upload').off().on('click', function () {

			div.modal('hide');
		});

		//hidden
		div.off().on('hidden.bs.modal', function (e) {
			lm_minu();
		})

		//show
		lm_add(div);
		div.modal('show');

		//autofocus
		_.delay(function () {
			div.find('input').eq(0).focus();
		}, 500)

	}

</script>


<div id="divmodal_ServiceinfoEditrecord" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="divmodal_ServiceinfoEditrecord_title"
 aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content alert-info" style="background-color: #f5f5f5;">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 id="divmodal_ServiceinfoEditrecord_title" class="modal-title">詳細服務紀錄</h4>
			</div>
			<div style="padding:20px 20px; background-color:#fafafa;">

				<div id="divmodal_ServiceinfoEditrecord_panel"></div>

			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" data-dismiss="modal">關閉</button>
			</div>
		</div>
	</div>
</div>